# Application Configuration
spring.application.name=Estoque Central

# Server Configuration
# Render sets PORT env var; locally defaults to 8081
server.port=${PORT:8081}

# Database Configuration (PostgreSQL)
# These will be overridden by environment variables in production
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5433/estoque_central}
spring.datasource.username=${DATABASE_USER:postgres}
spring.datasource.password=${DATABASE_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# Flyway Configuration
# Default Flyway (public schema) - runs V001__create_tenants_table.sql
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration/public
spring.flyway.schemas=public
# Multi-tenancy: Tenant schemas are migrated separately by FlywayMultiTenantConfig

# Redis Configuration (Story 7.5: Tenant-Isolated Cache)
# Set redis.enabled=true to activate Redis (cache, retry queues)
redis.enabled=${REDIS_ENABLED:false}
# Local Development: redis://localhost:6379
# Azure Production: rediss://{name}.redis.cache.windows.net:6380
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.database=${REDIS_DATABASE:0}
spring.data.redis.ssl.enabled=${REDIS_SSL_ENABLED:false}

# Spring Data JDBC
spring.data.jdbc.repositories.enabled=true

# OAuth 2.0 Configuration (Google)
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_OAUTH_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_OAUTH_CLIENT_SECRET}
spring.security.oauth2.client.registration.google.scope=openid,profile,email
spring.security.oauth2.client.registration.google.redirect-uri={baseUrl}/login/oauth2/code/google
spring.security.oauth2.client.provider.google.issuer-uri=https://accounts.google.com

# JWT Configuration
app.jwt.secret=${JWT_SECRET:change-this-secret-in-production-min-256-bits-estoque-central-2025}
app.jwt.expiration-ms=86400000

# Data Encryption Configuration (NFR14 - AES-256)
encryption.key=${ENCRYPTION_KEY:QUVTMjU2LURldktleS1Fc3RvcXVlQ2VudHJhbDIwMjY=}

# Actuator - Health Checks (Story 7.8)
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.health.db.enabled=true
management.health.redis.enabled=${REDIS_ENABLED:false}
management.endpoint.health.probes.enabled=true
# Health groups for liveness and readiness probes
management.endpoint.health.group.liveness.include=livenessState
management.endpoint.health.group.readiness.include=readinessState,database,redis
# Custom health indicators will be automatically detected
management.health.defaults.enabled=true

# Application Insights (Story 7.8 - AC3)
# Azure Application Insights for monitoring, logging, and tracing
applicationinsights.connection-string=${APPLICATIONINSIGHTS_CONNECTION_STRING:#{null}}
applicationinsights.instrumentation-key=${APPLICATIONINSIGHTS_INSTRUMENTATION_KEY:#{null}}
# Enable auto-collection
applicationinsights.web.enable-W3C=true
applicationinsights.logging.level=INFO
# Custom telemetry
applicationinsights.heartbeat.enabled=true
applicationinsights.performance-counter.enabled=true

# CORS Configuration
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:4200,http://localhost:8080,http://localhost:3000}

# SpringDoc OpenAPI
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.enabled=true

# Logging
logging.level.root=INFO
logging.level.com.estoquecentral=DEBUG
logging.level.org.flywaydb=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Redisson Configuration (Story 4.4: Delayed Queues, Story 7.5: Cache)
# For local: redis://localhost:6379
# For Azure: rediss://{name}.redis.cache.windows.net:6380
redis.address=${REDIS_ADDRESS:redis://localhost:6379}
redis.password=${REDIS_PASSWORD:}
redis.ssl.enabled=${REDIS_SSL_ENABLED:false}
redis.database=${REDIS_DATABASE:0}
